<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Triggers :: Tekton Tutorial</title>
    <link rel="canonical" href="https://redhat-scholars.github.io/tekton-tutorial/tekton-tutorial/triggers.html">
    <link rel="prev" href="private_reg_repos.html">
    <link rel="next" href="openshift/index.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="../_/img/NewRHDFullLogo_4-color_white-wordmark.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://redhat-scholars.github.io/tekton-tutorial">Tekton Tutorial</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="tekton-tutorial" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html"></a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="setup.html">Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setup.html#tekton-prerequisites">Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setup.html#download-tutorial-sources">Download Tutorial Sources</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setup.html#kubernetes-cluster">Choose your Kubernetes Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setup.html#deploy-tekton">Install Tekton</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setup.html#install-tekton-cli">Install Tekton CLI</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="tasks.html">Tasks</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="tasks.html#tekton-tasks]">Tasks</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="tasks.html#tekton-task-clone">Clone Source Code</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tasks.html#tekton-task-list-ws">Know your Workspace</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tasks.html#tekton-task-clustertask">Cluster Task</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tasks.html#tekton-tasks-points-to-ponder">Points to Ponder</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="tasks.html#tekton-task-build-sources">Build Cloud Native Application</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="tasks.html#build-sources">Build Sources</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="tasks.html#build-linux-image">Build Image</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="tasks.html#push-linux-image">Push Image</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tasks.html#tekton-task-deploy">Deploy Task</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tasks.html#tekton-task-run">TaskRun</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tasks.html#tekton-test-task-output">Test Task Output</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tasks.html#tekton-task-step-template">Step Template</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tasks.html#tekton-task-cleanup">Clean</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="pipelines.html">Pipelines</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pipelines.html#tekton-add-tasks">Add Tasks from Catalog</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pipelines.html#tekton-pipeline-create">Create Pipeline</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pipelines.html#tekton-pipeline-deploy">Deploy Pipeline</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pipelines.html#tekton-pipeline-run">Run Pipeline</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pipelines.html#tekton-test-pipeline">Test Pipeline</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pipelines.html#tekton-pipeline-cleanup">Clean</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="workspaces.html">Workspaces</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="workspaces.html#ws-overview">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="workspaces.html#ws-prepare">Prepare for Using Workspaces</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="workspaces.html#ws-tasks-deploy">Deploy Tasks from Catalog</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="workspaces.html#ws-deploy-nexus">Deploy Nexus</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="workspaces.html#ws-create-maven-settings-cm">Create Maven Settings</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="workspaces.html#ws-deploy-knative">Deploy Knative</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="workspaces.html#ws-check-sc">Check Default Storage Class</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="workspaces.html#ws-pipeline-overview">Java Application Pipeline</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="workspaces.html#ws-use-pvc">Using Persistent Volumes as Workspace</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="workspaces.html#ws-use-pvc-git-clone">Git Clone TaskRun</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="workspaces.html#ws-pvc-points-to-ponder">Points to Ponder</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="workspaces.html#ws-use-cm">Using ConfigMap as Workspace</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="workspaces.html#ws-use-cm-mvn-run">Run maven Task</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="workspaces.html#use-cm-points-to-ponder">Points to Ponder</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="workspaces.html#ws-deploy-pipeline">Deploy Pipeline</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="workspaces.html#ws-create-pipeline">Create Pipeline</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="workspaces.html#ws-run-pipeline">Run Pipeline</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="workspaces.html#ws-verify-service">Verify Deployed Service</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="workspaces.html#tekton-ws-cleanup">Cleanup</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="private_reg_repos.html">Private Registries and Repositories</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="private_reg_repos.html#tkn-prr-overview">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="private_reg_repos.html#tekton-pull-from-remote-repo">Pulling from Private Source Repository</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="private_reg_repos.html#tekton-github-repo-secret">Create Github PAT Secret</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="private_reg_repos.html#tekton-github-sa">Create Service Account</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="private_reg_repos.html#tekton-create-clone-pipeline">Create And Run Pipeline</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="private_reg_repos.html#tekton-push-to-external-reg">Pushing To External Registry</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="private_reg_repos.html#tekton-push-registry-secret">Create Registry Secret</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="private_reg_repos.html#tekton-build-sa">Create Service Account</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="private_reg_repos.html#tekton-create-build-push-pipeline">Create And Run Pipeline</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="private_reg_repos.html#tekton-remote-ref-points">Points to Ponder</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="private_reg_repos.html#tekton-auth-cleanup">Cleanup</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="triggers.html">Triggers</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#tkn-triggers-prepare">Prepare Namespace</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#tkn-create-sa"> Pipeline Service Account</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#tkn-triggers-init-repo">Initialize Source Repository</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#install-tekton-triggers">Install Tekton Triggers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#tkn-triggers-template">Trigger Template</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#tkn-triggers-bindings">Trigger Bindings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#tkn-triggers-eventlistener">Trigger Event Listener</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#tekton-triggers-in-action">Triggers in Action</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#tekton-triggers-ptp">Points to Ponder</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="openshift/index.html">OpenShift Pipelines</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="openshift/setup.html">Setup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="openshift/openshift_pipelines.html">Pipelines</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="openshift/openshift_pipelines.html#ocp-create-project">Create Project</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="openshift/openshift_pipelines.html#openshift-pipelines-prep-app-deploy">Prepare Application Deployment</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="openshift/openshift_pipelines.html#required-tasks">Required Cluster Tasks</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="openshift/openshift_pipelines.html#ocp-update-cluster-tasks">Update Cluster Tasks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="openshift/openshift_pipelines.html#ocp-deploy-app-from-git">Deploy Application from GitHub</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="openshift/openshift_pipelines.html#ocp-create-java-ksvc-pipeline-tpl">Pipeline Template for Java and Knative Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="openshift/openshift_pipelines.html#odc-create-ksvc-java-app">Deploy Application with Pipeline</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="openshift/openshift_pipelines.html#odc-view-pipelines">View Pipelines</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="openshift/openshift_pipelines.html#odc-watch-pipelines">Watch Pipelines</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="openshift/openshift_pipelines.html#odc-view-app">Application Topology</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="openshift/openshift_pipelines.html#odc-pipeline-points">Points to Ponder</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Tekton Tutorial</a></li>
    <li><a href="triggers.html">Triggers</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-scholars/tekton-tutorial/edit/tekton-tutorial-v2.0.0/documentation/modules/ROOT/pages/triggers.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Triggers</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>At the end of this chapter you will be able to :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What are Tekton Triggers</p>
</li>
<li>
<p>How to Trigger a Pipeline or Task based on Events</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tkn-triggers-overview"><a class="anchor" href="#tkn-triggers-overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Until now we have seen how to create Tasks and Pipelines. But whenever it comes to running the Tasks and Pipelines we always relied on doing it manually. In the Chapter we will be expoloring how to do it using Triggers, e.g. say you push a commit in to the source repository and it triggers a PipelineRun to deploy a new application or a TaskRun to push the image to container registry. Let&#8217;s rock!</p>
</div>
<div class="paragraph">
<p>If you are not in tutorial chapter folder, then navigate to the folder:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd $TUTORIAL_HOME/triggers</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tkn-triggers-prepare"><a class="anchor" href="#tkn-triggers-prepare"></a>Prepare namespace</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All exercises of this chapter will be done a namespace <code>triggers-demo</code>, let&#8217;s create and switch to the <code>triggers-demo</code> namespace.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl create ns triggers-demo
kubectl config set-context --current --namespace triggers-demo</code></pre>
</div>
</div>
<div class="paragraph">
<p>As part of this exercise we will need to install the following external tasks and cluster tasks to be installed in the namespace:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/tektoncd/catalog/tree/master/task/git-clone/0.1">git-clone</a></p>
</li>
<li>
<p><a href="https://github.com/tektoncd/catalog/tree/master/task/maven/0.1">maven</a></p>
</li>
<li>
<p><a href="https://raw.githubusercontent.com/openshift/tektoncd-pipeline-operator/master/deploy/resources/addons/02-clustertasks/buildah/buildah-task.yaml">buildah</a></p>
</li>
<li>
<p><a href="https://github.com/tektoncd/catalog/tree/master/task/kn/0.1">knative client(kn)</a></p>
</li>
</ul>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -n triggers-demo \
  -f <a href="https://raw.githubusercontent.com/tektoncd/catalog/master/task/git-clone/0.1/git-clone.yaml" class="bare">https://raw.githubusercontent.com/tektoncd/catalog/master/task/git-clone/0.1/git-clone.yaml</a> \
  -f <a href="https://raw.githubusercontent.com/tektoncd/catalog/master/task/maven/0.1/maven.yaml" class="bare">https://raw.githubusercontent.com/tektoncd/catalog/master/task/maven/0.1/maven.yaml</a> \
  -f <a href="https://raw.githubusercontent.com/openshift/tektoncd-pipeline-operator/master/deploy/resources/addons/02-clustertasks/buildah/buildah-task.yaml" class="bare">https://raw.githubusercontent.com/openshift/tektoncd-pipeline-operator/master/deploy/resources/addons/02-clustertasks/buildah/buildah-task.yaml</a> \
  -f <a href="https://raw.githubusercontent.com/tektoncd/catalog/master/task/kn/0.1/kn.yaml" class="bare">https://raw.githubusercontent.com/tektoncd/catalog/master/task/kn/0.1/kn.yaml</a> \
  -f <a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/workspaces/list-directory-task.yaml">$TUTORIAL_HOME/workspaces/list-directory-task.yaml</a></code></pre>
</div>
</div>
<div class="paragraph">
<p>Check if all the tasks are available:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">tkn task ls</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command should show an output like:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME               DESCRIPTION              AGE
buildah            Buildah task builds...   11 hours ago
git-clone          These Tasks are Git...   11 hours ago
kn                 This Task performs ...   9 minutes ago
list-directory     Simple directory li...   11 hours ago
maven              This Task can be us...   11 hours ago</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="ws-deploy-nexus"><a class="anchor" href="#ws-deploy-nexus"></a>Deploy Nexus</h3>
<div class="paragraph">
<p>To show maven artifact caching and using customized maven <code>settings.xml</code> we will deploy Sonatype Nexus to the cluster:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -n triggers-demo \
  -f <a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/install/utils/nexus.yaml" target="_blank" rel="noopener">$TUTORIAL_HOME/install/utils/nexus.yaml</a></code></pre>
</div>
</div>
<div class="paragraph">
<p>Wait for the nexus3 pod to come up before proceeding further with exercises:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">watch kubectl -n triggers-demo get pods,svc</code></pre>
</div>
</div>
<div class="paragraph">
<p>A sucessfully running nexus3 pod should show the following services and pods:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME                         READY   STATUS    RESTARTS   AGE
pod/nexus-75fff8bbbd-cmlxs   1/1     Running   0          3m25s

NAME                 TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)          AGE
service/nexus        NodePort    10.100.205.22   &lt;none&gt;        8081:31743/TCP   3m25s</code></pre>
</div>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset1_minikube"></a>Minikube</p>
</li>
<li>
<p><a id="tabset1_openshift"></a>OpenShift</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset1_minikube">
<div class="paragraph">
<p>The nexus maven repository could be opened using the url:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">minikube -p tektontutorial service nexus -n triggers-demo --url</code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">http://192.168.64.27:30102</code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset1_openshift">
<div class="paragraph">
<p>In OpenShift we can use routes to expose the service if we need to access it from outside the cluster by:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc expose svc -n triggers-demo nexus</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ws-create-maven-settings-cm"><a class="anchor" href="#ws-create-maven-settings-cm"></a>Create maven-settings ConfigMap</h3>
<div class="paragraph">
<p>For us to mount the maven <code>settings.xml</code>, we will create ConfigMap holding the custom maven settings.xml:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl create -n triggers-demo cm maven-settings \
  --from-file=settings.xml=<a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/workspaces/maven-settings.xml" target="_blank" rel="noopener">$TUTORIAL_HOME/workspaces/maven-settings.xml</a></code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">configmap/maven-settings created</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can check the ConfigMap contents using the command:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl get -n triggers-demo cm maven-settings -o yaml \
    -o jsonpath='{.data}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output of the above command should be same as in <a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/workspaces/maven-settings.xml" target="_blank" rel="noopener">maven-settings.xml</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="ws-deploy-knative"><a class="anchor" href="#ws-deploy-knative"></a>Deploy Knative Serving</h3>
<div class="paragraph">
<p>As we will be deploying a <a href="https://knative.dev">Knative</a> serverless application as part of the pipeline, that we will be running later in this chapter, lets deploy Knative to the cluster:</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset2_minikube"></a>Minikube</p>
</li>
<li>
<p><a id="tabset2_openshift"></a>OpenShift</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset2_minikube">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Do it only once per cluster
</td>
</tr>
</table>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$TUTORIAL_HOME/bin/<a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/bin/enable_knative.sh" target="_blank" rel="noopener">enable_knative.sh</a></code></pre>
</div>
</div>
<div class="paragraph">
<p>Wait for the serving deployment to complete without errors.</p>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset2_openshift">
<div class="paragraph">
<p>OpenShift users can install Knative by following the instructions <a href="https://docs.openshift.com/container-platform/4.6/serverless/installing_serverless/installing-openshift-serverless.html">here</a> for installing OpenShift Serverless.</p>
</div>
<div class="paragraph">
<p>Follow the instructions for installing the Serverless Operator on the cluster and then follow <a href="https://docs.openshift.com/container-platform/4.6/serverless/installing_serverless/installing-knative-serving.html#installing-knative-serving">the instructions for creating Knative Serving</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ws-check-sc"><a class="anchor" href="#ws-check-sc"></a>Check Default Storage Class</h3>
<div class="paragraph">
<p>Before we create our pipeline ensure that the kubernetes cluster has a default storage class defined:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl get sc</code></pre>
</div>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset3_minikube"></a>Minikube</p>
</li>
<li>
<p><a id="tabset3_openshift"></a>OpenShift</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset3_minikube">
<div class="paragraph">
<p>In minikube cluster it should show an output like:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code>NAME                 PROVISIONER                RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE
standard (default)   k8s.io/minikube-hostpath   Delete          Immediate           false                  44m</code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset3_openshift">
<div class="paragraph">
<p>An example default storage class in Google Cloud:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME                 PROVISIONER            RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE
standard (default)   kubernetes.io/gce-pd   Delete          WaitForFirstConsumer   true                   2d3h</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>If you dont have one please check <a href="https://kubernetes.io/docs/concepts/storage/storage-classes/">Kubernetes Docs</a> on how to have one configured.</p>
</li>
<li>
<p>In OpenShift cluster the default storage class varies based on the underlying cloud platform. Refer to <a href="https://docs.openshift.com/container-platform/4.5/storage/dynamic-provisioning.html">OpenShift Documentation</a> to know more.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_create_pvc"><a class="anchor" href="#_create_pvc"></a>Create PVC</h3>
<div class="paragraph">
<p>Create the PVC <code>tekton-tutorial-sources</code>, which we will use as part of the exercises in this chapter and the upcoming ones.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -n triggers-demo -f <a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/workspaces/sources-pvc.yaml" target="_blank" rel="noopener">$TUTORIAL_HOME/workspaces/sources-pvc.yaml</a></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tkn-triggers-create-pipeline"><a class="anchor" href="#tkn-triggers-create-pipeline"></a>Create Pipeline</h3>
<div class="paragraph">
<p>As part of the Trigger exercise we will be running the greeter-app-deploy pipeline, let&#8217;s deploy the pipeline to be used later:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -n triggers-demo \
  -f <a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/workspaces/greeter-app-deploy.yaml" target="_blank" rel="noopener">$TUTORIAL_HOME/workspaces/greeter-app-deploy.yaml</a></code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify the available pipelines:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">tkn pipeline -n triggers-demo ls</code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME                    AGE            LAST RUN   STARTED   DURATION   STATUS
greeter-app-deploy   1 minute ago   ---        ---       ---        ---</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deploy_gitea"><a class="anchor" href="#_deploy_gitea"></a>Deploy Gitea</h3>
<div class="paragraph">
<p>Since we need to trigger a Pipeline with a git push, we will deploy a Git server to the local cluster. This will avoid our neeting to expose the service to the public internet and also helps us to test things quickly with our local cluster setup.</p>
</div>
<div class="paragraph">
<p><a href="https://gitea.io/">Gitea</a> is super quick and easy to install self-hosted git service. Let&#8217;s deploy it into our Kubernetes cluster using an Operator.</p>
</div>
</div>
<div class="sect2">
<h3 id="_create_gitea_server"><a class="anchor" href="#_create_gitea_server"></a>Create Gitea Server</h3>
<div class="paragraph">
<p>We&#8217;ll run a script that creates the Gitea server for us locally passing in as a parameter to the script a minikube based hostname <code>GITEA_HOSTNAME</code> that will allow us to access the instance of Gitea from our host machine</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset4_minikube"></a>Minikube</p>
</li>
<li>
<p><a id="tabset4_openshift"></a>OpenShift</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset4_minikube">
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export GITEA_HOSTNAME="gitea.$(minikube ip).nip.io"
$TUTORIAL_HOME/bin/<a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/bin/create-gitea.sh" target="_blank" rel="noopener">create-gitea.sh</a> -g $GITEA_HOSTNAME</code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset4_openshift">
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$TUTORIAL_HOME/bin/<a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/bin/create-gitea.sh" target="_blank" rel="noopener">create-gitea.sh</a>
export GITEA_HOSTNAME=$(kubectl get route gitea -n triggers-demo -o jsonpath='{.spec.host}')</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In a separate shell you can follow the installation progress by tailing the logs of the gitea operator that was installed into your minikube cluster.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">stern gitea -n gitea-operator</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the script finishes, your gitea deployment should be completed.  A successful deployment will report:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">Gitea server installed and running</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want, you can confirm this by running this command</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl get pods,svc -lapp=gitea</code></pre>
</div>
</div>
<div class="paragraph">
<p>Which should yield output that looks something like the following</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME                        READY   STATUS    RESTARTS   AGE
pod/gitea-dc5699668-xnzm9   1/1     Running   0          69m

NAME            TYPE       CLUSTER-IP       EXTERNAL-IP   PORT(S)          AGE
service/gitea   NodePort   10.107.208.196   &lt;none&gt;        3000:31850/TCP   69m</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can access the gitea service using ingress url:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">open <a href="http://$GITEA_HOSTNAME" class="bare">http://$GITEA_HOSTNAME</a></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/gitea_home.png" alt="gitea home">
</div>
<div class="title">Figure 1. Gitea Home</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tkn-create-sa"><a class="anchor" href="#tkn-create-sa"></a>Create ServiceAccount, Roles and Role Bindings</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We need to query Kubernetes objects, create Triggers and finally deploy the Knative Service as part of this chapter&#8217;s exercies. Let&#8217;s create a Kubernetes Service Account and add the required roles/permissions:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -k <a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/triggers/rbac">$TUTORIAL_HOME/triggers/rbac</a></code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">serviceaccount/pipeline created
role.rbac.authorization.k8s.io/app-deployer-role created
role.rbac.authorization.k8s.io/tekton-triggers-admin created
role.rbac.authorization.k8s.io/tekton-triggers-createwebhook created
rolebinding.rbac.authorization.k8s.io/app-deployer-binding created
rolebinding.rbac.authorization.k8s.io/tekton-triggers-admin-binding created
rolebinding.rbac.authorization.k8s.io/tekton-triggers-createwebhook-binding created</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In OpenShift you might not need the <strong>pipeline</strong> SA, as the OpenShift Pipelines creates it by default
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tkn-triggers-init-repo"><a class="anchor" href="#tkn-triggers-init-repo"></a>Initialize Source Repository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To run the exercises of this chapter we need the following setup in Git(gitea):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A Git user, for the demo we will create user called <strong>gitea</strong> with password <strong>gitea</strong></p>
</li>
<li>
<p>A Git Repository named <code>tekton-greeter</code>, we will use <a href="https://github.com/redhat-scholars/tekton-tutorial-greeter" class="bare">https://github.com/redhat-scholars/tekton-tutorial-greeter</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We will run the following Task to perform the necessary intializations listed above:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl create -n triggers-demo \
  -f <a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/triggers/gitea-init-taskrun.yaml" target="_blank" rel="noopener">$TUTORIAL_HOME/triggers/gitea-init-taskrun.yaml</a></code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">taskrun.tekton.dev/init-gitea-qkf84 created</code></pre>
</div>
</div>
<div class="paragraph">
<p>View the task run  logs using,</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">tkn tr logs -f -a $(tkn tr ls -n triggers-demo | awk 'NR==2{print $1}')</code></pre>
</div>
</div>
<div class="paragraph">
<p>A successfull initializations should show an output like:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">[create-gitea-admin] Created Gitea admin user gitea:gitea

[init-gitea] Created git repo tekton-tutorial-greeter
[init-gitea] Repository Clone url http://gitea.192.168.64.7.nip.io/gitea/tekton-tutorial-greeter.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should now be able to open the <a href="http://$GITEA_HOME/tekton-tutorial-greeter.git" class="bare">http://$GITEA_HOME/tekton-tutorial-greeter.git</a> and check the repository sources, that we will use as part of this chapter&#8217;s exercises.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Gitea admin user is <strong>gitea</strong> and password <strong>gitea</strong>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="install-tekton-triggers"><a class="anchor" href="#install-tekton-triggers"></a>Install Triggers</h2>
<div class="sectionbody">
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset5_minikube"></a>Minikube</p>
</li>
<li>
<p><a id="tabset5_openshift"></a>OpenShift</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset5_minikube">
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -f <a href="https://storage.googleapis.com/tekton-releases/triggers/previous/v0.14.2/release.yaml" class="bare">https://storage.googleapis.com/tekton-releases/triggers/previous/v0.14.2/release.yaml</a></code></pre>
</div>
</div>
<div class="paragraph">
<p>Wait for the Tekton Trigger controller and webhook to be ready:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">watch kubectl -n tekton-pipelines get pods</code></pre>
</div>
</div>
<div class="paragraph">
<p>A successful Tekton run should have the highlighted Tekton Trigger pods running in the <code>tekton-pipelines</code>:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME                                           READY   STATUS    RESTARTS   AGE
tekton-pipelines-controller-849ccccd7f-gc6dp   1/1     Running   1          3d3h
tekton-pipelines-webhook-75bc7666c-9crwq       1/1     Running   1          3d3h
<mark>tekton-triggers-controller-697c9b844d-9lz4x    1/1     Running   0          15h</mark>
<mark>tekton-triggers-webhook-6bcb96f965-gqrbh       1/1     Running   0          15h</mark></code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset5_openshift">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In OpenShift, the OpenShift pipelines operator installs Tekton Pipelines and Tekton Triggers in openshift-pipelines namespace. It&#8217;s not needed install Tekton Triggers.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tkn-triggers-template"><a class="anchor" href="#tkn-triggers-template"></a>Trigger Template</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TriggerTemplate is responsible to create the Tekton Resources when it receives the Event from the EventListener.</p>
</div>
<div class="sect2">
<h3 id="tkn-triggers-create-template"><a class="anchor" href="#tkn-triggers-create-template"></a>Create Trigger Template</h3>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl create -n triggers-demo \
  -f <a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/triggers/greeter-trigger-template.yaml" target="_blank" rel="noopener">$TUTORIAL_HOME/triggers/greeter-trigger-template.yaml</a></code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">triggertemplate.triggers.tekton.dev/tekton-greeter-trigger-template created</code></pre>
</div>
</div>
<div class="paragraph">
<p>List the available TriggerTemplates:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">tkn tt -n triggers-demo ls</code></pre>
</div>
</div>
<div class="paragraph">
<p>It should be only one now:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME                                 AGE
tekton-greeter-trigger-template   1 minute ago</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="tkn-triggers-adjust-template-image"><a class="anchor" href="#tkn-triggers-adjust-template-image"></a>Adjust Trigger Template Image</h4>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset6_minikube"></a>Minikube</p>
</li>
<li>
<p><a id="tabset6_openshift"></a>OpenShift</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset6_minikube">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
by default the greeter pipeline&#8217;s default image tag that it builds to is the <code>example.com/tekton-tutorial/greeter</code>.  Hence, no further updates to the TriggerTemplate is necessary
</td>
</tr>
</table>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset6_openshift">
<div class="paragraph">
<p>When using OpenShift, we want to adjust the image tag that the pipeline builds.  We&#8217;ll do this by patching the image tag parameter of the trigger template to point to a local image stream:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl patch tt/tekton-greeter-trigger-template -n triggers-demo --type='json' -p='[{"op": "replace", "path": "/spec/resourcetemplates/0/spec/params/3/value", "value":"image-registry.openshift-image-registry.svc:5000/triggers-demo/greeter"}]'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tkn-triggers-bindings"><a class="anchor" href="#tkn-triggers-bindings"></a>Trigger Bindings</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TriggerBinding is responsible to bind the Event payload with Template Parameters. In this case it will bind the gitea event playload to TriggerTemplate parameters, inputs, outputs and workspaces.</p>
</div>
<div class="paragraph">
<p>Let us see a sample webhook payload that Git events from Gitea might look like:</p>
</div>
<div class="listingblock">
<div class="title">Gitea Payload sample</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "secret": "",
  "ref": "refs/heads/master",
  "before": "7efe116eb6a9763f648aad9061ce8d2f34b702bc",
  "after": "36865805cbaf23a865daa6b1e87fb0498b5eba61",
  "compare_url": "http://gitea.192.168.64.7.nip.io/gitea/tekton-tutorial-greeter/compare/7efe116eb6a9763f648aad9061ce8d2f34b702bc...36865805cbaf23a865daa6b1e87fb0498b5eba61",
  "commits": [
    {
      "id": "36865805cbaf23a865daa6b1e87fb0498b5eba61",
      "message": "Fix test\n",
      "url": "http://gitea.192.168.64.7.nip.io/gitea/tekton-tutorial-greeter/commit/36865805cbaf23a865daa6b1e87fb0498b5eba61",
      "author": {
        "name": "gitea",
        "email": "gitea@gitea.com",
        "username": "gitea"
      },
      "committer": {
        "name": "gitea",
        "email": "gitea@gitea.com",
        "username": "gitea"
      },
      "verification": null,
      "timestamp": "2020-11-16T07:25:01Z",
      "added": [],
      "removed": [],
      "modified": [
        "src/test/java/com/redhat/developers/GreetingResourceTest.java"
      ]
    }
  ],
  "head_commit": null,
  "repository": {
    "id": 1,
    "owner": {
      "id": 1,
      "login": "gitea",
      "full_name": "",
      "email": "gitea@gitea.com",
      "avatar_url": "http://gitea.192.168.64.7.nip.io/user/avatar/gitea/-1",
      "language": "en-US",
      "is_admin": false,
      "last_login": "2020-11-16T06:38:46Z",
      "created": "2020-11-16T06:32:30Z",
      "username": "gitea"
    },
    "name": "tekton-tutorial-greeter",
    "full_name": "gitea/tekton-tutorial-greeter",
    "description": "",
    "empty": false,
    "private": false,
    "fork": false,
    "template": false,
    "parent": null,
    "mirror": false,
    "size": 112,
    "html_url": "http://gitea.192.168.64.7.nip.io/gitea/tekton-tutorial-greeter",
    "ssh_url": "ssh://gitea@gitea.192.168.64.7.nip.io:2022/gitea/tekton-tutorial-greeter.git",
    "clone_url": "http://gitea.192.168.64.7.nip.io/gitea/tekton-tutorial-greeter.git",
    "original_url": "",
    "website": "",
    "stars_count": 0,
    "forks_count": 0,
    "watchers_count": 1,
    "open_issues_count": 0,
    "open_pr_counter": 0,
    "release_counter": 0,
    "default_branch": "master",
    "archived": false,
    "created_at": "2020-11-16T06:32:30Z",
    "updated_at": "2020-11-16T07:25:04Z",
    "permissions": {
      "admin": true,
      "push": true,
      "pull": true
    },
    "has_issues": true,
    "internal_tracker": {
      "enable_time_tracker": true,
      "allow_only_contributors_to_track_time": true,
      "enable_issue_dependencies": true
    },
    "has_wiki": true,
    "has_pull_requests": true,
    "ignore_whitespace_conflicts": false,
    "allow_merge_commits": true,
    "allow_rebase": true,
    "allow_rebase_explicit": true,
    "allow_squash_merge": true,
    "avatar_url": ""
  },
  "pusher": {
    "id": 1,
    "login": "gitea",
    "full_name": "",
    "email": "gitea@gitea.com",
    "avatar_url": "http://gitea.192.168.64.7.nip.io/user/avatar/gitea/-1",
    "language": "en-US",
    "is_admin": false,
    "last_login": "2020-11-16T06:38:46Z",
    "created": "2020-11-16T06:32:30Z",
    "username": "gitea"
  },
  "sender": {
    "id": 1,
    "login": "gitea",
    "full_name": "",
    "email": "gitea@gitea.com",
    "avatar_url": "http://gitea.192.168.64.7.nip.io/user/avatar/gitea/-1",
    "language": "en-US",
    "is_admin": false,
    "last_login": "2020-11-16T06:38:46Z",
    "created": "2020-11-16T06:32:30Z",
    "username": "gitea"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can use any attribute/data from the JSON payload and bind them as the value in TriggerBindings. For this chapter exercise we are interested in two attributes namely:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>after</strong>: the commit hash after our push is merged into the master</p>
</li>
<li>
<p><strong>repository.clone_url</strong>: The Git Repo clone url</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The HTTP Body and Headers of the event payload are available as <code>body</code> and <code>header</code> JSONPath variables. We can retrieve the values using JSONPath expressions. Check the <a href="https://github.com/tektoncd/triggers/blob/master/docs/triggerbindings.md#event-variable-interpolation">Event Variable Interpolation</a> for more details.</p>
</div>
<div class="paragraph">
<p>To retrieve the <code>after</code> and <code>repository.clone_url</code> we use will the JSONPath expressions <code>$(body.after)</code> and <code>$(body.repoistory.clone_url)</code> respectively.</p>
</div>
<div class="sect2">
<h3 id="tkn-triggers-create-bindings"><a class="anchor" href="#tkn-triggers-create-bindings"></a>Create Trigger Bindings</h3>
<div class="listingblock">
<div class="title"><a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/triggers/gitea-triggerbindings.yaml" target="_blank" rel="noopener">gitea-triggerbindings.yaml</a></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">---
apiVersion: triggers.tekton.dev/v1alpha1
kind: TriggerBinding
metadata:
  name: gitea-triggerbinding
spec:
  params:
    - name: gitrevision
      value: <mark>$(body.after)</mark>
    - name: gitrepositoryurl
      value: <mark>$(body.repository.clone_url)</mark></code></pre>
</div>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl create -n triggers-demo -f <a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/triggers/gitea-triggerbindings.yaml" target="_blank" rel="noopener">$TUTORIAL_HOME/triggers/gitea-triggerbindings.yaml</a></code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">triggerbinding.triggers.tekton.dev/gitea-triggerbinding created</code></pre>
</div>
</div>
<div class="paragraph">
<p>List the available TriggerBindings:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">tkn tb -n triggers-demo ls</code></pre>
</div>
</div>
<div class="paragraph">
<p>It should show an output like:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME                  AGE
gitea-triggerbinding   7 seconds ago</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tkn-triggers-eventlistener"><a class="anchor" href="#tkn-triggers-eventlistener"></a>Event Listener</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Event Listener is primary interace for external sources to send events, that will trigger the creation of Tekton resources defined as part of the TriggerTemplate.</p>
</div>
<div class="sect2">
<h3 id="tkn-triggers-create-eventlistener"><a class="anchor" href="#tkn-triggers-create-eventlistener"></a>Create Event Listener</h3>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -n triggers-demo -f <a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/triggers/gitea-eventlistener.yaml" target="_blank" rel="noopener">$TUTORIAL_HOME/triggers/gitea-eventlistener.yaml</a></code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">eventlistener.triggers.tekton.dev/gitea-webhook created</code></pre>
</div>
</div>
<div class="paragraph">
<p>List the available EventListeners:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">tkn el -n triggers-demo ls</code></pre>
</div>
</div>
<div class="paragraph">
<p>It should show an output like:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME           AGE
gitea-webhook   4 seconds ago</code></pre>
</div>
</div>
<div class="paragraph">
<p>Wait for the <code>gitea-webhook</code> event listener pod  to be running, each EventListener will have a service named <code>el-&lt;EventListener Name&gt;</code> exposed automatically for sources to send events to Triggers.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl get pods,svc -n triggers-demo -leventlistener=gitea-webhook</code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME                                    READY   STATUS    RESTARTS   AGE
pod/el-gitea-webhook-848875db8f-25r2r   1/1     Running   0          58s

NAME                       TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)    AGE
<mark>service/el-gitea-webhook   ClusterIP   10.96.121.97   &lt;none&gt;        8080/TCP   58s</mark></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_create_event_listener_ingress"><a class="anchor" href="#_create_event_listener_ingress"></a>Create Event Listener Ingress</h3>
<div class="paragraph">
<p>If you need the EventListner service to be available outside of the cluster thereby you can use them as part of the webhook, the service <code>el-gitea-webhook</code> needs to be exposed via Ingress:</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset7_minikube"></a>Minikube</p>
</li>
<li>
<p><a id="tabset7_openshift"></a>OpenShift</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset7_minikube">
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export EL_WEBHOOK_HOST="$(kubectl get svc -n triggers-demo el-gitea-webhook -o yaml \
  | yq r - 'metadata.name').$(minikube ip).nip.io"
export EL_WEBHOOK_LISTENER_PORT="$(kubectl get svc -n triggers-demo el-gitea-webhook -o yaml \
  | yq r - 'spec.ports.(name==listener).port')"</code></pre>
</div>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">yq w <a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/triggers/eventlistener-ingress.yaml" target="_blank" rel="noopener">$TUTORIAL_HOME/triggers/eventlistener-ingress.yaml</a> \
  spec.virtualhost.fqdn $EL_WEBHOOK_HOST \
  | yq w - 'spec.routes[0].services[0].name' el-gitea-webhook \
  | yq w - 'spec.routes[0].services[0].port' $EL_WEBHOOK_LISTENER_PORT \
  | kubectl apply -n triggers-demo -f  -</code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">httpproxy.projectcontour.io/el-gitea-webhook-ingress created</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s verify if the ingress has been configured correctly:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl get httpproxy -n triggers-demo el-gitea-webhook-ingress -o yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command should the following output (trimmed for brevity):</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">apiVersion: projectcontour.io/v1
kind: HTTPProxy
metadata:
  name: el-gitea-webhook-ingress
  namespace: triggers-demo
spec:
  routes:
  - services:
    - name: <mark>el-gitea-webhook</mark>
      port: <mark>8080</mark>
  virtualhost:
    fqdn: <mark>el-gitea-webhook.192.168.64.7.nip.io</mark></code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset7_openshift">
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc expose svc -n triggers-demo el-gitea-webhook
export EL_WEBHOOK_HOST=$(oc get route el-gitea-webhook -n triggers-demo -ojsonpath='{.spec.host}')</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tkn-triggers-configure-webhook"><a class="anchor" href="#tkn-triggers-configure-webhook"></a>Configure Webhook</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For the GitHub Triggers to work, we need to have the <a href="https://docs.gitea.io/en-us/webhooks/">Webhook</a> configured for the Git Repository <code>tekton-greeter</code> to point to the exposed host of our webhook service.  For this we will use the <code>tkn</code> cli:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -n triggers-demo -f <a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/triggers/gitea-webhook-task.yaml" target="_blank" rel="noopener">$TUTORIAL_HOME/triggers/gitea-webhook-task.yaml</a>
tkn task start gitea-create-webhook -n triggers-demo -s pipeline -p WEBHOOK_HOST="$EL_WEBHOOK_HOST"</code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">TaskRun started: gitea-create-webhook-run-l2dxl</code></pre>
</div>
</div>
<div class="paragraph">
<p>View the task run  logs using,</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">tkn tr logs -f -a $(tkn tr ls -n triggers-demo | awk 'NR==2{print $1}')</code></pre>
</div>
</div>
<div class="paragraph">
<p>A successful initializations should show an output like:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">[webhook-gitea] Configured webhook: http://el-gitea-webhook.192.168.64.7.nip.io</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you note now the <code>tekton-greeter</code> Git repository in Gitea is configured with the webhook to send Git events to EventListener.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/gitea_webhook_settings.png" alt="gitea webhook settings">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tekton-triggers-in-action"><a class="anchor" href="#tekton-triggers-in-action"></a>Triggers in Action</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_terminal_1"><a class="anchor" href="#_terminal_1"></a>Terminal 1</h3>
<div class="paragraph">
<p>As we expect the triggers to start a Pipeline, let&#8217;s open a new terminal and watch the running Pipelines:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">watch tkn pr -n triggers-demo ls</code></pre>
</div>
</div>
<div class="paragraph">
<p>You <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>c</kbd></span> the watch once you see it running and monitor the logs.</p>
</div>
</div>
<div class="sect2">
<h3 id="_terminal_2"><a class="anchor" href="#_terminal_2"></a>Terminal 2</h3>
<div class="paragraph">
<p>Open a new terminal and watch the logs the event listener to see the incoming events:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">stern -n triggers-demo gitea-webhook</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the event playload is received from the gitea server, you should see output(trimmed for brevity) as shown below:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">...
el-gitea-webhook-88bc89db-ld6jz event-listener {"level":"info","logger":"eventlistener","caller":"resources/create.go:93","msg":"Generating resource: kind: &amp;APIResource{Name:pipelineruns,Namespaced:true,Kind:PipelineRun,Verbs:[delete deletecollection get list patch create update watch],ShortNames:[pr prs],SingularName:pipelinerun,Categories:[tekton tekton-pipelines],Group:tekton.dev,Version:v1beta1,StorageVersionHash:4xDTCrDXyFg=,}, name: greeter-app-","knative.dev/controller":"eventlistener"}
el-gitea-webhook-88bc89db-ld6jz event-listener {"level":"info","logger":"eventlistener","caller":"resources/create.go:101","msg":"For event ID \"rrgcn\" creating resource tekton.dev/v1beta1, Resource=pipelineruns","knative.dev/controller":"eventlistener"}
...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_clone_and_edit_the_source"><a class="anchor" href="#_clone_and_edit_the_source"></a>Clone and Edit the source</h3>
<div class="paragraph">
<p>Using your favorite IDE clone the repo <code>tekton-greeter</code> from Gitea:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git clone <a href="http://gitea.$(minikube" class="bare">http://gitea.$(minikube</a> -p tektontutorial ip).nip.io/gitea/tekton-tutorial-greeter.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Open the <code>tekton-tutorial-greeter</code> in your IDE and edit the Java file:</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset8_quarkus"></a>Quarkus</p>
</li>
<li>
<p><a id="tabset8_springboot"></a>SpringBoot</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset8_quarkus">
<div class="ulist">
<ul>
<li>
<p><code>quarkus/src/main/java/com/redhat/developers/GreetingResource.java</code> to update the "Tekton  rocks " to "Tekton  Triggered"</p>
</li>
<li>
<p><code>quarkus/src/test/java/com/redhat/developers/GreetingResourceTest.java</code> to match "Tekton  Triggered".</p>
</li>
</ul>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset8_springboot">
<div class="ulist">
<ul>
<li>
<p><code>springboot/src/main/java/com/redhat/developer/demos/GreetingController.java</code> to update the "Meeow!! from Tekton " to "Tekton  Triggered"</p>
</li>
<li>
<p><code>springboot/src/test/java/com/redhat/developer/demos/GreetingControllerTest.java</code> to match "Tekton  Triggered".</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To ensure the pipeline builds the SpringBoot version of the repo, you must first update the <a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/triggers/greeter-trigger-template.yaml" target="_blank" rel="noopener">greeter-trigger-template</a> to pass in 'springboot' as the 'context-dir' parameter to the <a href="https://github.com/redhat-scholars/tekton-tutorial/blob/master/workspaces/greeter-app-deploy.yaml" target="_blank" rel="noopener">greeter-app-deploy</a> pipeline.  You can edit the trigger template or you can patch it using this command:
</td>
</tr>
</table>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl patch tt/tekton-greeter-trigger-template -n triggers-demo --type='json' -p='[{"op": "replace", "path": "/spec/resourcetemplates/0/spec/params/2/value", "value":"springboot"}]'</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Commit and push to see the  Pipeline <code>greeter-app-deploy</code> running .</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Use the username <code>gitea</code> and password <code>gitea</code> when prompted during Git push to repository.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>View the pipeline run logs using,</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">tkn pr logs -f -a $(tkn pr ls -n triggers-demo | awk 'NR==2{print $1}')</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the Pipeline succeeds, verify the Knative Service <code>greeter</code>:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">http --body $(kn service describe greeter -o url)/</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command should shown output like:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">Tekton  Triggered</code></pre>
</div>
</div>
<div class="paragraph">
<p>Expriment with updating the sources to your taste and see the pipeline triggers.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tekton-triggers-ptp"><a class="anchor" href="#tekton-triggers-ptp"></a>Points to Ponder</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use Tekton Triggers we need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A Kubernetes Service Account with required permissions assigned</p>
</li>
<li>
<p>A TriggerTemplate which defines which Tekton Resources to create for a given event</p>
</li>
<li>
<p>A TriggerBinding which allows to extract the data from an event payload and bind them to the Parameters of a Tekton Task/Pipeline</p>
</li>
<li>
<p>An EventListener that will listen for the events and trigger the execution of Tekton Resources as part of the Trigger Template</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tkn-triggers-cleanup"><a class="anchor" href="#tkn-triggers-cleanup"></a>Cleanup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you no longer going to use the triggers-demo, you can do:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl delete ns triggers-demo</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you no longer wish to have the Gitea operator installed, you can run:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl delete ns gitea-operator</code></pre>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="private_reg_repos.html">Private Registries and Repositories</a></span>
  <span class="next"><a href="openshift/index.html">OpenShift Pipelines</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
